service: blog

provider:
    name: aws
    stage: prod
    environment:
        APP_ENV: production
        APP_DEBUG: false
        APP_KEY: 'base64:/EStlF5sExBpWdQ3eB/h+F2zzKGDc5bvDzwe0KD8ZPg='

params:
    dev:
        brefLive: true
    prod:
        brefLive: false

package:
    patterns:
        - '!.env'
        - '!drafts/**'
        - '!node_modules/**'
        - '!public/storage'
        - '!resources/assets/**'
        - '!storage/**'
        - '!public/favicon.ico'
        - '!public/assets/**'
        - '!public/images/**'
        - '!public/presentations/**'

functions:
    web:
        handler: public/index.php
        description: 'mnapoli.fr'
        runtime: php-82-fpm
        timeout: 10
        brefLive: ${param:brefLive}
        events:
            - httpApi: '*'

plugins:
  - ./vendor/bref/bref
  - serverless-lift
  - '@bref.sh/live'

constructs:
    website:
        type: server-side-website
        assets:
            '/assets/*': public/assets
            '/images/*': public/images
            '/presentations/*': public/images
            '/favicon.ico': public/favicon.ico
            '/robots.txt': public/robots.txt
